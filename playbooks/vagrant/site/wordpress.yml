---
- name: Create WordPress Site
  hosts: vagrant
  remote_user: vagrant

  vars:
    dynamic_php: yes
  vars_prompt:
    - name: domain
      prompt: "New Domain Name (e.g. codeup.dev)"
      private: no

  pre_tasks:
    - name: Development domains must end with .dev
      assert:
        that: "domain.endswith('.dev')"

  roles:
    - php

  tasks:
    - name: Download WordPress
      get_url: url=https://wordpress.org/latest.tar.gz dest=/tmp/wordpress.tar.gz

    - name: Extract WordPress
      command: tar xzf /tmp/wordpress.tar.gz -C {{ www_home }}/{{ domain }}/public --strip-components=1
      args:
        creates: "{{ www_home }}/{{ domain }}/public/index.php"
